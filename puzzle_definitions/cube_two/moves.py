import numpy as np

def execute_move_full(state, move):
    new_state = {}
    new_state["co"] = move["cp"] @ state["co"]
    new_state["cp"] = move["cp"] @ state["cp"]
    if "co" in move:
        new_state["co"] = np.mod(new_state["co"]+move["co"], 3)
    return new_state

identity = np.array([[1,0,0,0,0,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0,0,0,0,0],
                        [0,0,0,0,1,0,0,0,0,0,0,0],
                        [0,0,0,0,0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0,0,0,0,0],
                        [0,0,0,0,0,0,0,1,0,0,0,0],
                        [0,0,0,0,0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,0,0,0,0,1]], np.dtype("int8"))
moves = {
    "U": {
        "cp": np.array([[1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,1,0,0,0]], np.dtype("int8"))
    },
    "U2": {
        "cp": np.array([[1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0]], np.dtype("int8"))
    },
    "U'": {
        "cp": np.array([[1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0]], np.dtype("int8"))
    },
    "R": {
        "co": np.array([0,0,1,2,0,0,2,1], np.dtype("int8")),
        "cp": np.array([[1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0]], np.dtype("int8"))
    },
    "R2": {
        "cp": np.array([[1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,1,0,0,0,0,0]], np.dtype("int8"))
    },
    "R'": {
        "co": np.array([0,0,1,2,0,0,2,1], np.dtype("int8")),
        "cp": np.array([[1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,1,0,0,0,0]], np.dtype("int8"))
    },
    "L": {
        "co": np.array([1,2,0,0,2,1,0,0], np.dtype("int8")),
        "cp": np.array([[0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1]], np.dtype("int8"))
    },
    "L2": {
        "cp": np.array([[0,0,0,0,0,1,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1]], np.dtype("int8"))
    },
    "L'": {
        "co": np.array([1,2,0,0,2,1,0,0], np.dtype("int8")),
        "cp": np.array([[0,0,0,0,1,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1]], np.dtype("int8"))
    },
    "D": {
        "cp": np.array([[0,0,0,1,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1]], np.dtype("int8"))
    },
    "D2": {
        "cp": np.array([[0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1]], np.dtype("int8"))
    },
    "D'": {
        "cp": np.array([[0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1]], np.dtype("int8"))
    },
    "F": {
        "co": np.array([0,1,2,0,0,2,1,0], np.dtype("int8")),
        "cp": np.array([[1,0,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,0,1]], np.dtype("int8"))
    },
    "F2": {
        "cp": np.array([[1,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,1]], np.dtype("int8"))
    },
    "F'": {
        "co": np.array([0,1,2,0,0,2,1,0], np.dtype("int8")),
        "cp": np.array([[1,0,0,0,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,0,0,0,1]], np.dtype("int8"))
    },
    "B": {
        "co": np.array([2,0,0,1,1,0,0,2], np.dtype("int8")),
        "cp": np.array([[0,0,0,0,1,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,1,0,0,0,0]], np.dtype("int8"))
    },
    "B2": {
        "cp": np.array([[0,0,0,0,0,0,0,1],
                        [0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0],
                        [1,0,0,0,0,0,0,0]], np.dtype("int8"))
    },
    "B'": {
        "co": np.array([2,0,0,1,1,0,0,2], np.dtype("int8")),
        "cp": np.array([[0,0,0,1,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,1,0,0,0]], np.dtype("int8"))
    },
    "x": {
        "co": np.array([1,2,1,2,2,1,2,1], np.dtype("int8")),
        "cp": np.array([[0,0,0,0,1,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,0,1,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0]], np.dtype("int8"))
    },
    "x2": {
        "cp": np.array([[0,0,0,0,0,1,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,0,0,1,0],
                        [0,1,0,0,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,1,0,0,0,0,0]], np.dtype("int8"))
    },
    "x'": {
        "co": np.array([1,2,1,2,2,1,2,1], np.dtype("int8")),
        "cp": np.array([[0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,1,0,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,1,0,0,0,0]], np.dtype("int8"))
    },
    "y": {
        "cp": np.array([[0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,1,0,0,0]], np.dtype("int8"))
    },
    "y2": {
        "cp": np.array([[0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0]], np.dtype("int8"))
    },
    "y'": {
        "cp": np.array([[0,0,0,1,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,0,0,1,0]], np.dtype("int8"))
    },
    "z": {
        "co": np.array([2,1,2,1,1,2,1,2], np.dtype("int8")),
        "cp": np.array([[0,0,0,1,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,0,0,1],
                        [1,0,0,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,1,0,0,0]], np.dtype("int8"))
    },
    "z2": {
        "cp": np.array([[0,0,0,0,0,0,0,1],
                        [0,0,0,0,0,0,1,0],
                        [0,0,0,0,0,1,0,0],
                        [0,0,0,0,1,0,0,0],
                        [0,0,0,1,0,0,0,0],
                        [0,0,1,0,0,0,0,0],
                        [0,1,0,0,0,0,0,0],
                        [1,0,0,0,0,0,0,0]], np.dtype("int8"))
    },
    "z'": {
        "co": np.array([2,1,2,1,1,2,1,2], np.dtype("int8")),
        "cp": np.array([[0,0,0,0,1,0,0,0],
                        [0,0,0,0,0,1,0,0],
                        [0,1,0,0,0,0,0,0],
                        [1,0,0,0,0,0,0,0],
                        [0,0,0,0,0,0,0,1],
                        [0,0,0,0,0,0,1,0],
                        [0,0,1,0,0,0,0,0],
                        [0,0,0,1,0,0,0,0]], np.dtype("int8"))
    }
}